{"ast":null,"code":"import AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { createSlice } from \"@reduxjs/toolkit\";\nimport { KEY_ACCESS_TOKEN } from \"../../../utils/grpc\";\nimport { StatusEnum } from \"../../constant\";\nimport { getMeThunk, loginThunk, logoutThunk } from \"./thunk\";\nexport var initialState = {\n  isSignedIn: false,\n  status: StatusEnum.LOADING,\n  email: \"\",\n  height: 0,\n  weight: 0,\n  username: \"\",\n  displayName: \"\",\n  phoneNumber: \"\"\n};\nvar slice = createSlice({\n  name: \"user\",\n  initialState: initialState,\n  reducers: {},\n  extraReducers: function extraReducers(builder) {\n    builder.addCase(getMeThunk.pending, function (state) {\n      state.status = StatusEnum.LOADING;\n    });\n    builder.addCase(getMeThunk.fulfilled, function (state, _ref) {\n      var _response$user, _response$user2, _response$user3, _response$user4, _response$user5, _response$user6;\n      var payload = _ref.payload;\n      var response = payload.response,\n        error = payload.error;\n      if (error) {\n        state.status = StatusEnum.SUCCEEDED;\n        state.isSignedIn = false;\n        return;\n      }\n      state.weight = (response == null ? void 0 : (_response$user = response.user) == null ? void 0 : _response$user.weight) || 0;\n      state.height = (response == null ? void 0 : (_response$user2 = response.user) == null ? void 0 : _response$user2.height) || 0;\n      state.displayName = (response == null ? void 0 : (_response$user3 = response.user) == null ? void 0 : _response$user3.displayName) || \"\";\n      state.email = (response == null ? void 0 : (_response$user4 = response.user) == null ? void 0 : _response$user4.email) || \"\";\n      state.phoneNumber = (response == null ? void 0 : (_response$user5 = response.user) == null ? void 0 : _response$user5.phoneNumber) || \"\";\n      state.username = (response == null ? void 0 : (_response$user6 = response.user) == null ? void 0 : _response$user6.username) || \"\";\n      state.status = StatusEnum.SUCCEEDED;\n      state.isSignedIn = true;\n    });\n    builder.addCase(loginThunk.fulfilled, function (state, _ref2) {\n      var payload = _ref2.payload;\n      var response = payload.response,\n        error = payload.error;\n      if (error) {\n        state.isSignedIn = false;\n        return;\n      }\n      var token = (response == null ? void 0 : response.accessToken) || \"\";\n      AsyncStorage.setItem(KEY_ACCESS_TOKEN, token);\n      state.isSignedIn = true;\n    });\n    builder.addCase(logoutThunk.fulfilled, function (state, _ref3) {\n      var payload = _ref3.payload;\n      state.isSignedIn = false;\n      AsyncStorage.removeItem(KEY_ACCESS_TOKEN);\n    });\n  }\n});\nexport var selectUserSlice = function selectUserSlice(state) {\n  return state.user;\n};\nexport var isUserSliceLoading = function isUserSliceLoading(state) {\n  return state.user.status === StatusEnum.LOADING;\n};\nexport default slice.reducer;","map":{"version":3,"names":["AsyncStorage","createSlice","KEY_ACCESS_TOKEN","StatusEnum","getMeThunk","loginThunk","logoutThunk","initialState","isSignedIn","status","LOADING","email","height","weight","username","displayName","phoneNumber","slice","name","reducers","extraReducers","builder","addCase","pending","state","fulfilled","payload","response","error","SUCCEEDED","user","token","accessToken","setItem","removeItem","selectUserSlice","isUserSliceLoading","reducer"],"sources":["/home/ngoalong/PhuMinh/HK221/dacn/curent/runtracking/frontend/src/redux/features/user/slice.ts"],"sourcesContent":["import AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { createSlice } from \"@reduxjs/toolkit\";\nimport { KEY_ACCESS_TOKEN } from \"../../../utils/grpc\";\nimport { CommonState } from \"../../common/types\";\nimport { StatusEnum } from \"../../constant\";\nimport { RootState } from \"../../reducers\";\nimport { getMeThunk, loginThunk, logoutThunk } from \"./thunk\";\n\ntype UserState = {\n  isSignedIn: boolean;\n  username: string;\n  displayName: string;\n  email: string;\n  phoneNumber: string;\n  height: number;\n  weight: number;\n} & CommonState;\n\nexport const initialState: UserState = {\n  isSignedIn: false,\n  status: StatusEnum.LOADING,\n  email: \"\",\n  height: 0,\n  weight: 0,\n  username: \"\",\n  displayName: \"\",\n  phoneNumber: \"\",\n};\n\nconst slice = createSlice({\n  name: \"user\",\n  initialState,\n  reducers: {},\n  extraReducers: (builder) => {\n    builder.addCase(getMeThunk.pending, (state) => {\n      state.status = StatusEnum.LOADING;\n    });\n    builder.addCase(getMeThunk.fulfilled, (state, { payload }) => {\n      const { response, error } = payload;\n      if (error) {\n        state.status = StatusEnum.SUCCEEDED;\n        state.isSignedIn = false;\n        return;\n      }\n      state.weight = response?.user?.weight || 0;\n      state.height = response?.user?.height || 0;\n      state.displayName = response?.user?.displayName || \"\";\n      state.email = response?.user?.email || \"\";\n      state.phoneNumber = response?.user?.phoneNumber || \"\";\n      state.username = response?.user?.username || \"\";\n\n      state.status = StatusEnum.SUCCEEDED;\n      state.isSignedIn = true;\n    });\n    builder.addCase(loginThunk.fulfilled, (state, { payload }) => {\n      const { response, error } = payload;\n      if (error) {\n        state.isSignedIn = false;\n        return;\n      }\n      const token = response?.accessToken || \"\";\n      AsyncStorage.setItem(KEY_ACCESS_TOKEN, token);\n      state.isSignedIn = true;\n    });\n    builder.addCase(logoutThunk.fulfilled, (state, { payload }) => {\n      state.isSignedIn = false;\n      AsyncStorage.removeItem(KEY_ACCESS_TOKEN);\n    });\n  },\n});\n\nexport const selectUserSlice = (state: RootState) => state.user;\nexport const isUserSliceLoading = (state: RootState) =>\n  state.user.status === StatusEnum.LOADING;\n\nexport default slice.reducer;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}